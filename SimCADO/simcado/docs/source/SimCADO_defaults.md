
# SimCADO configuration for MICADO

SimCADO's main purpose is to simulate the optical train comprising of the E-ELT and MICADO. As such the base configuration is for this instrument/telescope combination.

Although SimCADO allows the user to configure the optical train as they like, it is *highly* recommended to leave the default parameters alone if the goal of the simulations is comparability between scientific use cases.

This document lists the current configuration which best describes MICADO. Each section describes a physical effect included by SimCADO and **gives the Keyword/Value pair** contained in the default configuration file **for MICADO**.

**Data Source**

The data for this table is generated from this [Excel sheet](https://github.com/gastronomyk/SimCADO/blob/master/SimCADO/simcado/docs/SimCADO_defaults.xlsx)

## MICADO Spatial effects

------ 

### Point spread function

**Description:** What happens before the deformable mirrors is a mystery to SimCADO. All SimCADO needs is the effective PSF for the chosen AO mode. 

Currently SimCADO assumes a single PSF for the whole field. This will change when position dependent PSFs become available

SCAO PSFs have been provided by Yann Clenet for the JHK. LTAO PSFs from ESOs 2012 study are included. Ideal (no atmosphere) generated by the JWST POPPY optics tool are also included.

 

```
SCOPE_PSF_FILE = data/PSF_SCAO.fits     
# ["scao" (default), <filename>, "ltao", "mcao", "poppy"] import a PSF from a file.
```

 Source: Yann Clenet, updated on 11.11.2016

 **NEEDED : MCAO PSF, SCAO position-dep PSFs**

![./images/PSF_SCAO.fits.png](./images/PSF_SCAO.fits.png) 

------ 

### Atmospheric Dispersion Correction

**Description:** The number of surfaces in the ADC is set to 8. A constant transmission curve of 0.98 is assumed for each of these surfaces, thus the total throughput of a perfectly functioning ADC is `0.98^8 = 0.85` over the wavelength range 0.5-3.0um

SimCADO implements an inverse ADC. It assumes that the ADC corrects perfectly for the dispersion induced by the atmosphere. If the ADC isn't working as it should, i.e. `INST_ADC_PERFORMANCE` less than 100%, SimCADO calculates the distance an uncorrected image/slice would be from the centre of the FoV, then shifts the image/slice by `shift = AD * (1 - 0.01 * INST_ADC_PERFORMANCE)`. By calculating this shift for each slice in the spectral cube, SimCADO recreates the smearing effect of an imperfect ADC.

What is needed is real model for how the ADC residuals affect the image on the focal plane

 

```
INST_ADC_PERFORMANCE  = 100     # [%] how well the ADC does its job
```

 Source: Best guess, updated on 02.11.2016

 **NEEDED : Model for ADC, unless % performance metric is OK. How does slip/give translate to FP shift?**

```
INST_ADC_NUM_SURFACES  = 8     # number of surfaces in the ADC
```

 Source: Email from Ric, updated on 02.11.2016

 **NEEDED : Number of surfaces, unless a curve/number can be supplied for the whole ADC. **

```
INST_ADC_TC  = data/TC_ADC.dat     # transmission curve of the ADC
```

 Source: Best guess, updated on 02.11.2016

 **NEEDED : Real TC or at least approx %. Is TC dependent on position of prisms?**

![./images/TC_ADC.dat.png](./images/TC_ADC.dat.png) 

------ 

### Derotator

**Description:** **Not fully implemented**

Similar to the ADC, SimCADO assumes the derotator is perfect. If the performance is less that 100%, SimCADO calculates the field rotation based on the `OBS_EXPTIME` value and then creates a series of rotated focal plane readouts and adds them together to simulate the rotational smear of a poor derotator performance.

`INST_DEROT_PROFILE` can be linear or gaussian

 

```
INST_DEROT_PERFORMANCE = 100     # [%] how well the derotator derotates
```

 Source: Best guess, updated on 02.11.2016

 **NEEDED : How do distances (mm, um) translate to FP angles (mas, arcsec)**

```
INST_DEROT_PROFILE = linear     
# [linear, gaussian] the profile with which it does it's job
```

 Source: Best guess, updated on 02.11.2016

 **NEEDED : Is a linear shift OK? Whats the best model for this?**

## MICADO transmission effects

------ 

### MICADO mirrors

**Description:** For Wide-field (4mas) mode, 11 mirrors are in the optical train. For Zoom (1.5mas) mode, 13 mirrors are used. 

The default mirror coating is currently the same as the E-ELTs MgF2 coating with a AgAl protective layer. **Are MICADOs mirror coatings similar?**

 

```
INST_NUM_MIRRORS = 11     # number of reflecting surfaces in MICADO
```

 Source: MICADO optical design, updated on 02.11.2016

```
INST_MIRROR_TC = data/TC_mirror_mgf2agal.dat     
# If "default", INST_MIRROR_TC = SCOPE_M1_TC
```

 Source: ESO E-ELT technical database, updated on 02.11.2016

 **NEEDED : What coating materials are we going to use? Which possibilities?**

![./images/TC_mirror_mgf2agal.dat.png](./images/TC_mirror_mgf2agal.dat.png) 

------ 

### Filters

**Description:** The transmission curves for filters are for the filter as a whole unit. Individual surface transmission curves (i.e. 2 per filter) are not taken into account.

SimCADO currently accepts all the broadband filters in the MICADO wavelength range as well as a series of narrow band filters:

* I, z, Y, J, H, Ks, K
* Bracket Gamma (2.16um)
* Paschen Beta (1.28um)
* CH4 at 1.69um
* CH4 at 2.27um
* FeII at 1.66um
* H2 at 2.12um
* H2O at 2.04um
* NH3 at 1.52um

More filters can be added upon request

 

```
INST_FILTER_TC = data/TC_filter_Ks.dat     
# [<filename>, string(filter name)] List acceptable filters with >>> simcado.optics.get_filter_set()
```

 Source: ESO E-ELT technical database, updated on 02.11.2016

 **NEEDED : Which filters will be available**

![./images/TC_filter_Ks.dat.png](./images/TC_filter_Ks.dat.png) 

------ 

### Cryostat window

**Description:** The entrance window for MICADO. At the moment we assume a transmission of approx 95% per surface. 

 

```
INST_ENTR_NUM_SURFACES = 4     
# number of surfaces on the entrance window
```

 Source: Email from Ric, updated on 02.11.2016

 **NEEDED : Is the number for a single surface or for the whole entrance window?**

```
INST_ENTR_WINDOW_TC = data/TC_window.dat     # [<filename>, "default"]
```

 Source: Best guess, updated on 02.11.2016

 **NEEDED : Ideally a transmission curve for the full window. Also acceptable is a single number. At the least, a meterial name/composition so that I can search**

![./images/TC_window.dat.png](./images/TC_window.dat.png) 

------ 

### Instrumental distorion

**Description:** Much like the PSF, SimCADO only cares about the total distortion introduced to the system. Our idea to implement this to take 2x 2D arrays for the focal plane, one each for the x and y shifts introduced by the distorion. SimCADO will then interpolate for each photon source position and make the x,y shifts accordingly. 

 

```
INST_DISTORTION_MAP = none     # path to distortion map
```

 Source: Currently not implemented in SimCADO, updated on 02.11.2016

 **NEEDED : ideally an rough estimate of the current distorion. Acceptable would be a number for the distortion at the edge of the FoV**

------ 

### Surface roughness

**Description:** Due to surface errors (order 50nm?) some percentage of the light is scattered. This translates effectively into an additional transmission curve+ emission curve, where the transmission is reduced by the percentage given in `INST_SURFACE_FACTOR` and the lost photons (`=1-INST_SURFACE_FACTOR`) are added to the background light contribution over the full focal plane

This approach is probably unrealistic as not nearly all the scattered light makes it to the detectors

 

```
INST_SURFACE_FACTOR = data/TC_surface.dat     
# Wavelength dependent effect on transmission due to surface roughness.
```

 Source: Email from Ric, updated on 02.11.2016

 **NEEDED : wavelength dep curve for loss of light over [0.7, 2.5]um. Also, % of scattered light that makes it to detector**

![./images/TC_surface.dat.png](./images/TC_surface.dat.png) 

------ 

### Dichroics

**Description:** The question is if these are really necessary in the simulations, seeing as they only affect a small area of the pupil

The dichroic in MAORY is important though. 

 

```
INST_DICHROIC_NUM_SURFACES = 2     
# number of surfaces on the entrance window
```

 Source: Best guess, updated on 02.11.2016

 **Is the TC for a full element or per surface?**

```
INST_DICHROIC_TC = data/TC_dichroic.dat     # [<filename>, "default"]
```

 Source: Best guess, updated on 02.11.2016

 **Currently we are assuming 100% transmission. What material?**

![./images/TC_dichroic.dat.png](./images/TC_dichroic.dat.png) 

------ 

### Pupil optics

**Description:** **How do the pupil optics affect the image in practical terms?**

 

```
INST_PUPIL_NUM_SURFACES = 2     # number of surfaces on the pupil window
```

 Source: Email from Ric, updated on 02.11.2016

 **Is the TC for a single or both surfaces?**

```
INST_PUPIL_TC = data/TC_pupil.dat     # [<filename>, "default"]
```

 Source: Best guess, updated on 02.11.2016

 **NEEDED : Did I understand this will be Zerodur+Cr **

## MICADO Detector effects

------ 

### Quantum efficiency



```
FPA_QE = data/TC_detector_H4RG.dat     # Quantum efficiency of detector.
```

![./images/TC_detector_H4RG.dat.png](./images/TC_detector_H4RG.dat.png) 

------ 

### Chip noise characteristics

**Description:** If a noise file (`FPA_NOISE_PATH`) is provided, then this is used as the chip noise. This file must however be downloaded and added to the package as it is not shipped with SimCADO due to size

`FPA_USE_NOISE` toggles the detector noise on and off

Read noise and dark current are based on the defaults from the Hawaii xRG noise generator code (Rauscher 2015)

 

```
FPA_USE_NOISE = yes     # [yes/no]
```

```
FPA_NOISE_PATH = data/FPA_noise.fits     
# [default/generate/filename] if "generate": use NGHxRG to create a noise frame
```

![./images/FPA_noise.fits.png](./images/FPA_noise.fits.png) 

```
FPA_READOUT_MEDIAN = 4     # e-/px
```

```
FPA_READOUT_STDEV = 1     # e-/px
```

```
FPA_DARK_MEDIAN = 0.01     # e-/s/px
```

```
FPA_DARK_STDEV = 0.01     # e-/s/px
```

------ 

### Chip dynamic range



```
FPA_GAIN = 1     # e- to ADU conversion
```

```
FPA_WELL_DEPTH = 100000     
# number of photons collectable before pixel is full
```

```
FPA_LINEARITY_CURVE = data/FPA_linearity.dat     
# [<filename>, "none", "default"]
```

![./images/FPA_linearity.dat.png](./images/FPA_linearity.dat.png) 



------ 

### Hawaii 4RG Simulator

**Description:** These values are the defaults from the Hawaii xRG noise generator code (Rauscher 2015)

 

**Description:** Number of read out channels per chip

 ```
HXRG_NUM_OUTPUTS = 32
```

**Description:** Number of row overhead in pixels

 ```
HXRG_NUM_ROW_OH = 8
```

**Description:** Factor for correlated pink noise

 ```
HXRG_CORR_PINK = 3
```

**Description:** Factor for uncorrelated pink noise

 ```
HXRG_UNCORR_PINK = 1
```

**Description:** Factor for Alternating Column Noise

 ```
HXRG_ALT_COL_NOISE = 0.5
```

**Description:** Magnitude of pedestal drift

 ```
HXRG_PEDESTAL = 4
```

------ 

### Pixel sensitivity

**Description:** The pixel sensitivity of a detector. Can be specified as a FITS file covering the 4k detector, or a random sample of dead lines/pixels. The default is  `FPA_PIXEL_MAP = none`, and so SimCADO creates dead pixels and lines

The units are in [%], i.e. the default values are 1%

**Needs to be revised for hot pixels**

 

```
FPA_PIXEL_MAP = none     
# path to a FITS file with the pixel sensitivity map
```

```
FPA_DEAD_PIXELS = 1     
# [%] if FPA_PIXEL_MAP=none, a percentage of detector pixel which are dead
```

 Source: Simms+ 2007 for H2RG, updated on 02.11.2016

```
FPA_DEAD_LINES = 1     
# [%] if FPA_PIXEL_MAP=none, a percentage of detector lines which are dead
```

------ 

### Detector layout

**Description:** For the sake of quick computations, the default value for the SimCADO detector array (`small`) describes a single 1024x1024 pixel windowed read-out at the centre of the FoV. 

This allows the user to gain a quick look at whether the output will be useful before investing >10 minutes is a full simulation.

Acceptable values for `FPA_CHIP_LAYOUT`

* "small"   - 1x 1k-detector centred in the FoV
* "centre"  - 1x 4k detector centred in the FoV
* "wide"    - 9x 4k-detector as per MICADO wide field mode (4mas)
* "zoom"    - 9x 4k-detector as per MICADO zoom mode (1.5mas)
* "default" - depends on "mode" keyword. Full MICADO detector array.

Custom layouts for different windowing schemes are also possible by specifying the position of the centre of the window and its width/height in pixels in `arcsec` relative to the centre of the FoV.

 

```
FPA_CHIP_LAYOUT = data/FPA_chip_layout_small.dat     
# ["small", "centre", "wide", "zoom", "full", <filename>] description of the chip layout on the detector array
```

------ 

### MICADO Detector read modes





## External optical elements

------ 

### MAORY mirrors

**Description:** The same mirror coating is assumed for the MAORY mirrors as for the E-ELT and MICADO

Here we also assume 7x  mirrors, held at ambient temperature emitting as grey bodies. The total surface area (`INST_MIRROR_AO_SUM_AREA`) of all mirrors in the AO system are used for the thermal background

 



```
INST_NUM_AO_MIRRORS = 7     
# number of reflecting surfaces between telescope and instrument (i.e. MAORY)
```

 Source: Best guess, updated on 02.11.2016

 **REAL DATA NEEDED**

```
INST_MIRROR_AO_TC = data/TC_mirror_mgf2agal.dat     
# If "default", INST_MIRROR_AO_TC = SCOPE_M1_TC
```

 Source: Best guess, updated on 02.11.2016

 **REAL DATA NEEDED**

![./images/TC_mirror_mgf2agal.dat.png](./images/TC_mirror_mgf2agal.dat.png) 

```
INST_AO_TEMPERATURE = 0     # deg Celsius - inside temp of AO module
```

 Source: Best guess, updated on 02.11.2016

```
INST_MIRROR_AO_LIST = data/EC_mirrors_ao.tbl     
# List of mirrors in the AO. 
```

![./images/EC_mirrors_ao.tbl.png](./images/EC_mirrors_ao.tbl.png) 

## Telescope optics

------ 

### E-ELT optical surfaces

**Description:** The optical surfaces for the telescope. SimCADO only cares about the transmission of the mirrors. MICADO only cares about the post-AO PSF, and so does SimCADO

Telescope Jitter (wind, vibrations) and tracking drift are taken into account in a very basic fashion, similar to the ADC shift

 

```
SCOPE_M1_TC = data/TC_mirror_mgf2agal.dat     
# [<filename>, "default"] Mirror reflectance curve.
```

 Source: ESO E-ELT optics webpage, updated on 02.11.2016

![./images/TC_mirror_mgf2agal.dat.png](./images/TC_mirror_mgf2agal.dat.png) 

```
SCOPE_M1_TEMP = 0     # deg Celsius - temperature of mirror
```

```
SCOPE_MIRROR_LIST = data/EC_mirrors_scope.tbl     
# [<filename>, "default"] List of mirror sizes
```

 Source: ESO E-ELT optics webpage, updated on 02.11.2016

------ 

### Wind jitter and telescope vibrations



```
SCOPE_JITTER_FWHM = 0.001     
# [arcsec] gaussian telescope jitter (wind, tracking)
```

```
SCOPE_DRIFT_DISTANCE = 0     
# [arcsec/sec] the drift in tracking by the telescope
```

```
SCOPE_DRIFT_PROFILE = linear     
# [linear, gaussian] the drift profile. If linear, simulates when tracking is off. If gaussian, simulates rms distance of tracking errors
```

## Atmospheric Effects

------ 

### Background light



```
ATMO_USE_ATMO_BG = yes     # [yes/no] 
```

```
ATMO_EC = data/skytable.fits     
# [<filename>, "default", "none"] for atmospheric emission curve.
```

 Source: SkyCalc Uni IBK, updated on 2016-01-01 00:00:00

![./images/skytable.fits[emission].png](./images/skytable.fits[emission].png) 

```
ATMO_BG_MAGNITUDE = data/EC_sky_magnitude.dat     
# If ATMO_EC is "none": set ATMO_BG_MAGNITUDE for the simulation filter. 
```

------ 

### Transmission



```
ATMO_TC = data/skytable.fits     
# [<filename>, "default"] for atmospheric transmission curve
```

 Source: SkyCalc Uni IBK, updated on 2016-01-01 00:00:00

![./images/skytable.fits[transmission].png](./images/skytable.fits[transmission].png) 

------ 

### Atmospheric conditions



```
ATMO_TEMPERATURE = 0     # deg Celcius
```

```
ATMO_PRESSURE = 750     # millibar
```

```
ATMO_REL_HUMIDITY = 60     # %
```

------ 

### Telescope location parameters

**Description:** Currently only used for getting the atmospheric dispersion

 

```
SCOPE_ALTITUDE = 3060     # meters above sea level
```

 Source: wikipedia, updated on 2016-11-16 00:00:00

```
SCOPE_LATITUDE = -24.589167     # decimal degrees
```

 Source: wikipedia, updated on 2016-11-16 00:00:00

```
SCOPE_LONGITUDE = -70.192222     # decimal degrees
```

 Source: wikipedia, updated on 2016-11-16 00:00:00





